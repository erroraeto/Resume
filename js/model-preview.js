import*as THREE from"three";import{GLTFLoader}from"three/addons/loaders/GLTFLoader.js";import{OrbitControls}from"three/addons/controls/OrbitControls.js";let buttonListMod=document.querySelectorAll(".list-model__button"),progressiveBlur=document.querySelector(".progressive-blur"),canvas=document.querySelector(".list-model__canvas"),content=document.querySelector(".list-model__content"),renderer,scenes=[],models=[],texture=[],group=[],iconSrc=["./icons/draw.svg","./icons/sculpt.svg","./icons/retopo.svg","./icons/uv.svg","./icons/bake.svg","./icons/t-paint.svg","./icons/w-paint.svg"],title=["CONCEPT DESIGN","SCULPTING","RETOPOLOGY","UNWRAP","BAKING","TEXTURING","RIGGING & SKINNING"],description=["- is an early phase of the design process, in which the broad outlines of function and form of something are articulated.","- manipulate a digital object as if it were made of a real-life substance such as clay.","- is the process of creating a new, cleaner polygonal mesh for a 3D model while preserving its original shape.","- projecting a 3D model's surface to a 2D image for texture mapping.","- is the process of saving complex details, like lighting, shadows, and surface irregularities, from a high-polygon model or scene into a flat, 2D texture map.","- is the process of applying images or other data (textures) to a 3D model to give it a realistic appearance, color, and other surface properties.","- rigging is creating a virtual skeleton (a rig) for a 3D model, while skinning is the process of binding the 3D model's surface (the 'skin') to that skeleton."];async function init(){var e,t,o;await(new THREE.TextureLoader).loadAsync("./img/texture/reference.webp").then(e=>{texture.push(e)}),await(new THREE.TextureLoader).loadAsync("./img/texture/texture__norm-sculpt.webp").then(e=>{e.flipY=!1,texture.push(e)}),await(new THREE.TextureLoader).loadAsync("./img/texture/texture__norm.webp").then(e=>{e.flipY=!1,texture.push(e)}),await(new THREE.TextureLoader).loadAsync("./img/texture/texture__matcap.webp").then(e=>{e.encoding=THREE.SRGBColorSpace,texture.push(e)}),await(new THREE.TextureLoader).loadAsync("./img/texture/texture__uv-grid.webp").then(e=>{e.flipY=!1,e.colorSpace=THREE.SRGBColorSpace,texture.push(e)}),await(new THREE.TextureLoader).loadAsync("./img/texture/texture__paint.webp").then(e=>{e.flipY=!1,texture.push(e)}),await(new THREE.TextureLoader).loadAsync("./img/texture/texture__weight.webp").then(e=>{e.flipY=!1,texture.push(e)}),await(new GLTFLoader).loadAsync("./models/bust-highpoly.glb").then(e=>{e=e.scene.children[0];models.push(e)}),await(new GLTFLoader).loadAsync("./models/bust-lowpoly.glb").then(e=>{e=e.scene.children[0];models.push(e)}),await(new GLTFLoader).loadAsync("./models/bust-wireframe.glb").then(e=>{e=e.scene.children[0];e.material.transparent=!0,e.material.opacity=.2,models.push(e)}),await(new GLTFLoader).loadAsync("./models/bust-seam.glb").then(e=>{e=e.scene.children[0];e.material.transparent=!0,e.material.opacity=.2,models.push(e)}),await(new GLTFLoader).loadAsync("./models/bust-rig.glb").then(e=>{e=e.scene.children[0];e.material.transparent=!0,e.material.opacity=.4,models.push(e)}),t=new THREE.Group,e=texture[0].image.width/texture[0].image.height,(o=new THREE.Mesh(new THREE.PlaneGeometry(2.5,2.5),new THREE.MeshLambertMaterial({map:texture[0],side:THREE.DoubleSide}))).scale.set(e,1,1),t.add(o),group.push(t),e=new THREE.Group,(o=models[0].clone()).material=new THREE.MeshMatcapMaterial({color:(new THREE.Color).setHex(11579568),matcap:texture[3],normalMap:texture[1],side:THREE.DoubleSide}),e.add(o),group.push(e),t=new THREE.Group,(o=models[1].clone()).material=new THREE.MeshLambertMaterial({normalMap:texture[2],side:THREE.DoubleSide}),t.add(o),o=models[2].clone(),t.add(o),group.push(t),e=new THREE.Group,(o=models[1].clone()).material=new THREE.MeshLambertMaterial({map:texture[4],side:THREE.DoubleSide}),e.add(o),(o=models[3].clone()).material=new THREE.LineBasicMaterial({color:16776960,linewidth:1}),e.add(o),group.push(e),t=new THREE.Group,(o=models[1].clone()).material=new THREE.MeshLambertMaterial({map:texture[2],normalMap:texture[2],side:THREE.DoubleSide}),t.add(o),group.push(t),e=new THREE.Group,(o=models[1].clone()).material=new THREE.MeshLambertMaterial({map:texture[5],normalMap:texture[2],side:THREE.DoubleSide}),e.add(o),group.push(e),t=new THREE.Group,(o=models[1].clone()).material=new THREE.MeshLambertMaterial({map:texture[6],normalMap:texture[2],side:THREE.DoubleSide}),t.add(o),o=models[4].clone(),t.add(o),group.push(t);for(let e=0;e<group.length;e++){var a=new THREE.Scene,n=document.createElement("div"),r=(n.className="list-item",document.createElement("div")),s=(r.className="preview",n.appendChild(r),document.createElement("div")),i=(s.className="specification",n.appendChild(s),progressiveBlur.cloneNode(!0)),i=(s.appendChild(i),document.createElement("div")),l=(i.className="specification__title",s.appendChild(i),document.createElement("img")),l=(l.src=iconSrc[e],i.appendChild(l),document.createElement("h2")),i=(l.innerText=title[e],i.appendChild(l),document.createElement("p")),l=(i.className="specification__content",i.innerText=description[e],s.appendChild(i),document.createElement("button")),s=(l.type="button",l.value=e,l.addEventListener("click",listControl),l.className="list-item__gimbal",l.style.backgroundImage="url(./icons/gimbal.svg)",n.appendChild(l),a.userData.element=r,content.appendChild(n),new THREE.PerspectiveCamera(50,1,1,10)),i=(s.position.z=2,a.userData.camera=s,new OrbitControls(a.userData.camera,a.userData.element));i.minDistance=2,i.maxDistance=5,i.enablePan=!1,i.enableZoom=!1,(a.userData.controls=i).enabled=!1,group[e].scale.set(.5,.5,.5),group[e].rotation.y=-.2,a.add(group[e]),a.add(new THREE.HemisphereLight(11184810,4473924,3)),scenes.push(a),0==e&&(n.classList.add("open"),a.userData.controls.enabled=!0)}renderer=new THREE.WebGLRenderer({canvas:canvas,antialias:!0,alpha:!0}),updateSize(),renderer.setAnimationLoop(animate)}function updateSize(){var e=Array.from(content.children).at(1),t=Array.from(content.children).at(-1);renderer.setSize(t.offsetLeft+t.offsetWidth+e.offsetLeft,content.scrollHeight),renderer.setPixelRatio(window.devicePixelRatio)}function animate(){updateSize(),renderer.setScissorTest(!1),renderer.clear(),renderer.setScissorTest(!0),scenes.forEach(function(e){var t=e.userData.element,o=t.parentElement,o={left:o.offsetLeft+t.offsetLeft,top:o.offsetTop+t.offsetTop,right:o.offsetLeft+t.offsetLeft+t.clientWidth,bottom:o.offsetTop+t.offsetTop+t.clientHeight},a=o.right-o.left,n=o.bottom-o.top,r=o.left,o=renderer.domElement.clientHeight-o.bottom,r=(renderer.setViewport(r,o,a,n),renderer.setScissor(r,o,a,n),e.userData.camera);r.aspect=t.clientWidth/t.clientHeight,r.updateProjectionMatrix(),renderer.render(e,r)})}function listMove(e){"prev"==e.target.closest("button").name?content.scrollTo({left:content.scrollLeft-content.children[1].clientWidth,behavior:"smooth"}):"next"==e.target.closest("button").name&&content.scrollTo({left:content.scrollLeft+content.children[1].clientWidth,behavior:"smooth"})}function listControl(e){renderer.setAnimationLoop(animate);var t,e=e.target.value,o=scenes[e].userData.element.offsetParent,e=scenes[e].userData.controls,a=content.querySelector(".open");a&&a!=o&&(t=a.querySelector(".list-item__gimbal").value,t=scenes[t].userData.controls,a.classList.remove("open"),t.enabled=!1),o.classList.toggle("open"),e.enabled=1!=e.enabled,setTimeout(()=>{0==content.querySelectorAll(".open").length&&renderer.setAnimationLoop(null)},500)}init(),buttonListMod.forEach(e=>{e.addEventListener("click",listMove)}),content.addEventListener("scroll",e=>{content.scrollLeft-content.children[1].offsetLeft<=0?buttonListMod[0].style="opacity: 0; visibility: hidden":buttonListMod[0].style="",content.scrollLeft+content.offsetWidth+content.children[1].offsetLeft>=content.scrollWidth?buttonListMod[1].style="opacity: 0; visibility: hidden":buttonListMod[1].style=""});